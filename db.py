import sqlite3
events_data = [
    ["Французька революція", 1789, "Франція",
     "Французька революція (1789–1799) радикально змінила політичну систему Франції, поклавши край абсолютній монархії. Ключові події: штурм Бастилії (1789), страта Людовіка XVI (1793), період Якобінського терору. Революція проголосила ідеї свободи, рівності та братерства, вплинувши на всі європейські країни. Завершилась переворотом Наполеона Бонапарта 1799 року. \n\n"
     "Революція також сприяла поширенню громадянських прав і секуляризації державного управління. Вперше були створені декларації прав людини, надано виборче право (хоча й обмежене), скасовано феодальні привілеї. Вона надихнула інші національні рухи та спричинила тривалий період нестабільності в Європі, що завершився Наполеонівськими війнами.",
     "revolution.jpg"],

    ["Віденський конгрес", 1815, "Відень",
     "Віденський конгрес (1814–1815) скликаний після поразки Наполеона для встановлення нового європейського порядку. Основні рішення: відновлення кордонів Франції станом на 1792 рік; створення Німецького союзу з 39 держав; перерозподіл територій: Росія отримала Царство Польське, Пруссія — Рейнську область; встановлення принципу легітимізму (відновлення законних монархій); проголошення вічного нейтралітету Швейцарії.\n\n"
     "Конгрес заклав основи Віденської системи міжнародних відносин, яка проіснувала до Кримської війни. Його робота символізувала початок дипломатичних конференцій у новітній історії. Конгрес прагнув не допустити нових революцій і конфліктів, однак жорстке повернення до монархізму викликало невдоволення серед народів. Зрештою, створена система виявилася нестійкою через нехтування національними інтересами багатьох народів.",
     "vienna_congress.jpg"],

    ["Скасування кріпацтва в Росії", 1861, "Російська імперія",
     "19 лютого 1861 року імператор Олександр II підписав Маніфест про скасування кріпацтва. Реформа надала особисту свободу 23 мільйонам кріпаків, дозволила селянам викуповувати землю через общину, але зберегла значні привілеї поміщиків і викликала масове незадоволення обох сторін.\n\n"
     "Попри величезне значення, реформа мала обмежений успіх: більшість селян отримали малородючі землі, викупні платежі тривали десятиліттями. Водночас це був поштовх до модернізації імперії: зростання промисловості, поява мобільного населення, реформи в судовій системі, армії та освіті. Скасування кріпацтва стало передумовою революційного руху і загострення соціального питання в Росії.",
     "serfdom_abolition.jpg"],

    ["Об'єднання Італії", 1861, "Італія",
     "Процес Рісорджименто (1815–1871) завершився створенням єдиної Італійської держави. Основні етапи: революції 1848–1849 років, війни з Австрією за північні території, похід «Тисячі» Гарібальді (1860), проголошення Королівства Італія 17 березня 1861 року. Останніми до складу увійшли Венеція (1866) та Рим (1870). Королем став Віктор Емануїл II з Савойської династії.\n\n"
     "Об'єднання стало наслідком політичної дипломатії Кавура, патріотизму Гарібальді та загального національного піднесення. Водночас Італія залишалась розділеною економічно й соціально: Північ була індустріалізованою, а Південь — аграрним і бідним. Після об'єднання країна почала активно модернізуватися, однак залишалася політично нестабільною і мала складні стосунки з католицькою церквою до 1929 року.",
     "italian_unification.jpg"],

    ["Паризька комуна", 1871, "Париж",
     "Паризька комуна — революційний уряд, що існував у Парижі з 18 березня по 28 травня 1871 року після поразки Франції у війні з Пруссією. Вона впровадила прогресивні реформи: відділення церкви від держави, безкоштовну освіту, самоуправління, підтримку праці. Комуна діяла лише 72 дні та була жорстоко придушена версальськими військами: страчено 20–30 тисяч комунарів.\n\n"
     "Комуна стала символом боротьби робітничого класу за соціальну справедливість і вперше реалізувала ідею диктатури пролетаріату. Вона глибоко вплинула на розвиток марксизму і була проаналізована Марксом як перша спроба робітничої революції. Ця подія продемонструвала глибину соціальних конфліктів у Франції та в Європі загалом.",
     "paris_commune.jpg"],

    ["Американська громадянська війна", 1861, "США",
     "Війна між Північчю (Союз) і Півднем (Конфедерація) тривала 1861–1865 роки. Головна причина — питання рабства, а також економічні та політичні розбіжності. Переломний момент — битва під Геттісбургом (1863), проголошення Лінкольном Прокламації про звільнення рабів (1863). Загальні втрати — понад 600 тис. осіб. Війна завершилася перемогою Півночі, скасуванням рабства та відновленням Союзу.\n\n"
     "Цей конфлікт змінив американське суспільство, прискорив індустріалізацію та централізацію держави. Водночас виникла проблема реконструкції Півдня та расових відносин, яка залишалась болючою ще століттями. Війна сприяла утвердженню США як єдиної нації та демократичної держави, де права громадян стали основою політичного життя.",
     "american_civil_war.jpg"],

    ["Індустріальна революція", 1760, "Великобританія",
     "Перехід від аграрного до індустріального суспільства (1760–1840). Ключові інновації: паровий двигун (Джеймс Ватт, 1775), механічний верстат (текстильна промисловість), розвиток залізниць (перша лінія Ліверпуль–Манчестер, 1830). Наслідки: урбанізація, формування робітничого класу, стрімкий економічний зріст.\n\n"
     "Цей процес привів до появи нових класів — буржуазії та пролетаріату, посилення експлуатації праці, зміни у структурі родини та життя. Він також стимулював розвиток науки, медицини, транспорту й комунікацій. У відповідь виникли перші робітничі рухи — лудити, профспілки, чартисти, що боролись за права працівників.",
     "industrial_revolution.jpg"],

    ["Кримська війна", 1853, "Крим",
     "Війна (1853–1856) між Росією та коаліцією (Османська імперія, Великобританія, Франція, Сардинія). Основні події: героїчна оборона Севастополя (349 днів), перша війна з масовим використанням нарезної зброї, знаменита діяльність медсестер (Флоренс Найтінгейл). Завершилася Паризьким мирним договором 1856 року, що обмежив вплив Росії на Чорному морі.\n\n"
     "Кримська війна продемонструвала технологічну відсталість Російської імперії, що згодом стало поштовхом до реформ. Вона також стала першою війною, яку широко висвітлювали у пресі та за допомогою фотографії. Геополітично вона порушила стабільність Віденської системи та заклала основи нових конфліктів у Європі й на Балканах.",
     "crimean_war.jpg"],

    ["Заснування Германської імперії", 1871, "Німеччина",
     "18 січня 1871 року у Версалі проголошено створення Німецької імперії. Основні етапи об'єднання: війни з Данією (1864) та Австрією (1866), Франко-прусська війна (1870–1871), до складу увійшли 22 монархії та 3 вільних міста. Першим кайзером став Вільгельм I, канцлером — Отто фон Бісмарк.\n\n"
     "Об'єднання стало результатом прагматичної політики Бісмарка — «залізом і кров’ю». Нова імперія швидко перетворилася на одну з провідних держав Європи, з потужною економікою та армією. Це змінило баланс сил на континенті та створило передумови до Першої світової війни. Бісмарк встановив внутрішній мир, проте залишив без вирішення соціальні суперечності.",
     "german_empire.jpg"],

    ["Велика колоніальна експансія", 1880, "Світ",
     "Період «Гонки за Африку» (1880–1914), коли європейські держави поділили континент. Ключові події: Берлінська конференція 1884–1885 років, Британська імперія контролювала 1/4 суші, Франція отримала великі території в Західній Африці, бельгійське жорстоке панування в Конго. До 1914 року лише Ефіопія та Ліберія зберегли незалежність.\n\n"
     "Колоніалізм спричинив глибокі соціальні, культурні й економічні зміни в підкорених країнах: руйнування традицій, експлуатація ресурсів, примусова праця. Водночас це стимулювало інфраструктурний розвиток колоній. Колоніальна політика викликала спротив і зародила національно-визвольні рухи, які проявилися в ХХ столітті в Африці, Азії та Латинській Америці.",
     "colonial_expansion.jpg"]
]


db_name = "events.db"

def open_connection():
    conn = sqlite3.connect(db_name)
    conn.row_factory = sqlite3.Row  # Щоб можна було звертатись до колонок як до словника
    return conn

def create_events_table():
    conn = open_connection()
    cursor = conn.cursor()
    cursor.execute(
        """
        CREATE TABLE IF NOT EXISTS events(
            id INTEGER PRIMARY KEY AUTOINCREMENT,
            title TEXT,
            year INTEGER,
            location TEXT,
            description TEXT,
            image TEXT
        )
        """
    )
    conn.commit()
    conn.close()

def insert_event(title, year, location, description, image):
    conn = open_connection()
    cursor = conn.cursor()
    cursor.execute(
        "INSERT INTO events (title, year, location, description, image) VALUES (?, ?, ?, ?, ?)",
        (title, year, location, description, image)
    )
    conn.commit()
    conn.close()

def get_all_events():
    conn = open_connection()
    cursor = conn.cursor()
    cursor.execute("SELECT * FROM events")
    events = cursor.fetchall()
    conn.close()
    return events

def get_event_by_id(event_id):
    conn = open_connection()
    cursor = conn.cursor()
    cursor.execute("SELECT * FROM events WHERE id = ?", (event_id,))
    event = cursor.fetchone()
    conn.close()
    return event

def search_events(query):
    query = f"%{query}%"
    conn = open_connection()
    cursor = conn.cursor()
    cursor.execute(
        "SELECT * FROM events WHERE title LIKE ? OR description LIKE ? OR location LIKE ?",
        (query, query, query)
    )
    results = cursor.fetchall()
    conn.close()
    return results

if __name__ == "__main__":
    create_events_table()
    
    # Вставка подій у базу — робимо тільки якщо таблиця порожня, щоб не дублювати дані
    if len(get_all_events()) == 0:
        for event in events_data:
            insert_event(*event)
        print("Events inserted successfully!")

    # Вивід усіх подій
    events = get_all_events()
    for e in events:
        print(dict(e))
